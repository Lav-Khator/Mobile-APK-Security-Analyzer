<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>APK Armor - Attack on Anomalies</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>

<body>
    <header>
        <div class="logo">APK ARMOR <i class="fas fa-shield-alt"></i></div>
        <div>
            <a href="{{ url_for('index') }}" class="cyber-btn" style="margin-right: 1rem;">
                <i class="fas fa-redo"></i> New Scan
            </a>
            <a href="{{ url_for('download_file', filename=filename) }}" class="cyber-btn">
                <i class="fas fa-file-pdf"></i> Download PDF
            </a>
        </div>
    </header>

    <main>
        <div class="dashboard">
            <!-- Executive Summary -->
            <div class="glass-card">
                <h2><i class="fas fa-search"></i> Security Overview: {{ data.apk_name }}</h2>
                <div class="summary-grid">
                    <div class="stat-card">
                        <h3>Vulnerabilities</h3>
                        <div class="stat-value">{{ data.vulnerabilities|length }}</div>
                    </div>
                    <div class="stat-card">
                        <h3>Critical Secrets</h3>
                        <div class="stat-value">{{ data.hardcoded_secrets|length }}</div>
                    </div>
                    <div class="stat-card">
                        <h3>Dangerous Perms</h3>
                        <div class="stat-value">{{ data.dangerous_permission|length }}</div>
                    </div>
                    <div class="stat-card">
                        <h3>Network Risks</h3>
                        <div class="stat-value">{{ data.insecure_requests|length }}</div>
                    </div>
                </div>
            </div>

            <!-- Detailed Findings -->
            <div class="glass-card">
                <h2><i class="fas fa-bug"></i> Detected Vulnerabilities</h2>
                <div class="vuln-list">
                    {% if data.vulnerabilities %}
                    {% for vuln in data.vulnerabilities %}
                    <div class="finding-item severity-{{ vuln.severity|lower }}">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <strong style="color: var(--primary-color);">{{ vuln.id }}</strong>
                            <span class="badge badge-{{ vuln.severity|lower }}">{{ vuln.severity }}</span>
                        </div>
                        <p style="margin: 0.5rem 0; color: #ccc;">{{ vuln.description }}</p>
                        {% if vuln.path %}
                        <small style="color: #7f8c8d; display: block; overflow-wrap: break-word;">
                            <i class="fas fa-code"></i> {{ vuln.path }}
                        </small>
                        {% endif %}
                    </div>
                    {% endfor %}
                    {% else %}
                    <div class="finding-item severity-low">
                        <strong style="color: #2ed573;">Clean Scan!</strong>
                        <p>No major vulnerabilities detected based on current ruleset.</p>
                    </div>
                    {% endif %}
                </div>
            </div>
        </div>
    </main>

    <footer>
        <p>&copy; 2026 APK Armor - Attack on Anomaly | Secure Static Analysis</p>
    </footer>
</body>

</html>